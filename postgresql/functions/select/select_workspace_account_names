CREATE OR REPLACE FUNCTION public.select_workspace_account_names(
	arg_account_index integer,
	arg_workspace_index integer)
    RETURNS TABLE(tb_code integer, tb_account_name character varying)
    LANGUAGE 'plpgsql'

    COST 100
    VOLATILE
    ROWS 1000

AS $BODY$
DECLARE
	check_query boolean := false;
	v_account_names CHARACTER VARYING [];

BEGIN
	check_query := (SELECT * FROM public.is_available_ref_account_workspace(arg_account_index, arg_workspace_index));

	IF check_query IS FALSE THEN
		tb_code := -100;
		RETURN NEXT;
	ELSE
		v_account_names := ARRAY(SELECT account_name FROM public.ref_account_workspace
				INNER JOIN public.account ON public.account.id = public.ref_account_workspace.id_account
				WHERE public.ref_account_workspace.id_workspace = arg_workspace_index);

		tb_Account_name = ARRAY_TO_STRING(v_account_names, ',');
		tb_code = 0;
		RETURN NEXT;
	END IF;
END;$BODY$;