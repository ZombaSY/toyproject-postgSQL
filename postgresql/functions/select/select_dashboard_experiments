CREATE OR REPLACE FUNCTION public.select_dashboard_experiments(
    arg_account_index INTEGER,
    arg_workspace_key TEXT,
    arg_tab_code INTEGER)

    RETURNS TABLE(
        tb_code INTEGER,
        tb_project_name TEXT,
        tb_experiment_name TEXT,
        tb_experiment_creator_name TEXT,
        tb_experiment_status INTEGER,
        tb_experiment_created_date TIMESTAMP)

AS
$$
DECLARE
    return_code INTEGER;
    r RECORD;
    v_query BOOLEAN;
BEGIN

    IF arg_tab_code = 0 THEN    -- "MY" tab --

    ELSE IF arg_tab_code = 1 THEN   -- "RUNNING" tab

    ELSE IF arg_tab_code = 2 THEN   -- "RECENT" tab

    END IF;


    FOR r IN
	    (SELECT project.visibility, project.id FROM public.project
            INNER JOIN public.ref_account_workspace ON project.belonged_workspace_id = ref_account_workspace.id_workspace
            INNER JOIN public.workspace ON workspace.id = ref_account_workspace.id_workspace
			WHERE ref_account_workspace.id_account = arg_account_index AND
			      workspace.access_key = arg_workspace_key)
	LOOP
        CASE r.visibility

            WHEN 0 THEN -- public project --
                return_code := 0;

            WHEN 1 THEN -- private project --
                v_query := (SELECT is_available_private_project FROM public.is_available_private_project(
                    r.id,arg_account_index));

                IF v_query IS TRUE THEN
                    return_code := 0;
                ELSE
                    return_code := -1;  -- not belonged to private project --
                END IF;

            ELSE    -- not belonged to private project --
                return_code := -100; -- unknown visibility --

        END CASE;

    RETURN NEXT;
	END LOOP;
END;
$$

LANGUAGE 'plpgsql';
